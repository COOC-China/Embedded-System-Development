嵌入式系统底层开发
===============

##作者

周庆国 郑灵翔 康筱彬 刘同山

##前言

自第一款搭载嵌入式系统的智能手机HTC G1发布至今已近六年，凭借日益完善与强大的功能、完全开放的内核源码以及谷歌公司在网络应用领域的无缝支持，嵌入式系统从初出茅庐的行业新锐，已经成长壮大为手持设备智能化产业的推动者和市场的领导者，这一点已经毋庸置疑。

不可否认，众多独立软件开发者与商业软件公司的加入使嵌入式系统不再仅仅是作为终端产品，还以开发平台的身份深入到各行业，包括学校、公司等乃至开发人员的日常生活，这是嵌入式系统旺盛生命力的表现，同时也是嵌入式系统持续发展壮大的保障。近期，支持嵌入式系统的开发板如Zynq、Galileo等在功能不断完善的前提下成本也在大幅下降，助力了嵌入式系统推广与拓展；可穿戴设备以及嵌入式芯片的应用又将为嵌入式系统及其软硬件开发提供新的发展机遇。接触嵌入式系统领域、使用嵌入式系统产品、学习嵌入式系统，现在已经成为计算机软件、电子、自动化控制及相关专业的大学生，以及参加工作的软硬件工程师的首选之一。

但是目前在市场上同类的嵌入式系统相关书籍中，多是介绍基于嵌入式系统 SDK的单纯应用程序（App）的开发且种类繁杂，对于嵌入式系统的底层源码与系统内核的分析、驱动程序设计与存储优化、平台移植与内核测试等较为深入的内容则甚少涉及，为了对这些底层领域稍作弥补，作者编写了本书。

本书少用专业术语，浅显易懂的向广大嵌入式系统爱好者和开发人员讲解嵌入式系统下嵌入式开发板的系统设计。

全书共八章，可以分为四个部分：

* 第一部分为预备知识篇，简要介绍嵌入式系统的定义与软硬件开发以及嵌入式系统开发环境的搭建。即为基础知识，有一定Linux基础和嵌入式系统开发经验的读者可以选读。
* 第二部分为系统结构篇，主要介绍嵌入式系统的源码结构、内核与相关工具以及环境库。内容包括：嵌入式系统源码结构、init初始化脚本、Zygote、嵌入式系统编译；嵌入式系统内核启动、Binder框架、Ashmen内存管理、系统日志Logger实现；嵌入式系统开发工具、Dalvik虚拟机、JNI、Bootloader。
* 第三部分为驱动设计篇，主要介绍嵌入式系统中常用外接设备的驱动架构以及实现。内容包括NDK编程、嵌入式系统中HAL模型架构与实现流程。作为教学实例，最后还分析了嵌入式系统中的Camera与WIFI两个功能部件的的驱动设计。
* 第四部分为实例分析篇，通过对具体开发板硬件结构编程原理的介绍到系统级的实例讲解。在简要介绍系统底层开发流程的基础上，首先分析了主流的Zynq和Galileo平台上开发环境的搭建、Linux内核以及嵌入式系统的编译、下载；然后结合前文学习过的知识点，从零开始设计LED显示系统的Linux内核驱动、嵌入式系统 HAL支持和服务层设计、顶层App的实现；作为进阶部分，本书最后介绍了对嵌入式系统内核进行跟踪调试与性能测试的工具软件、工作流程以及结果分析。

##致谢

在此要特别感谢本书的策划张国强先生，是他对嵌入式系统和嵌入式系统开发的关注促成了这本书的出版，同时笔者在撰写书稿时也对本书提出了宝贵的写作建议，并进行了仔细的审阅。

本书的编写同样离不开许多朋友们的支持，在此特别要感谢兰州大学信息科学与工程学院的陈华明同学在书籍全程编写的帮助，这本书的出版离不开他背后的贡献。

还要感谢兰州大学的高博，郭守超，王小强和朱芳芳同学，感谢他们在整个编写过程中所给予的帮助与建议。